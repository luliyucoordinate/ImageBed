---
layout: post
title: Leetcode 919：完全二叉树插入器（最详细的解法！！！）
category : 算法
tags : [python, c, c++]
stickie: true
date: 2018-10-08 00:00:00
---

完全二叉树是每一层（除最后一层外）都是完全填充（即，结点数达到最大）的，并且所有的结点都尽可能地集中在左侧。

设计一个用完全二叉树初始化的数据结构 `CBTInserter`，它支持以下几种操作：

- `CBTInserter(TreeNode root)` 使用头结点为 `root` 的给定树初始化该数据结构；
- `CBTInserter.insert(int v)` 将 `TreeNode` 插入到存在值为 `node.val = v`  的树中以使其保持完全二叉树的状态，**并返回插入的 TreeNode 的父结点的值**；
- `CBTInserter.get_root()` 将返回树的头结点。


**示例 1：**

```
输入：inputs = ["CBTInserter","insert","get_root"], inputs = [[[1]],[2],[]]
输出：[null,1,[1,2]]
```

**示例 2：**

```
输入：inputs = ["CBTInserter","insert","insert","get_root"], inputs = [[[1,2,3,4,5,6]],[7],[8],[]]
输出：[null,3,4,[1,2,3,4,5,6,7,8]]
```

**提示：**

1. 最初给定的树是完全二叉树，且包含 `1` 到 `1000` 个结点。
2. 每个测试用例最多调用 `CBTInserter.insert`  操作 `10000` 次。
3. 给定结点或插入结点的每个值都在 `0` 到 `5000` 之间。

**解题思路**

这个问题实际在考察堆的初始化和插入操作。堆的初始化，实际上就是堆的遍历过程，参考二叉树的层次遍历即可[Leetcode 102:二叉树的层次遍历（最详细解决方案！！！）](http://blog.csdn.net/qq_17550379/article/details/80824320)。插入操作也很简单，先找到父节点，我们通过完全二叉树的性质很容易知道`parent=(len(q)-1)/2`

```python
class CBTInserter:
    def __init__(self, root):
        """
        :type root: TreeNode
        """
        self.data, q = list(), [root]
        while any(q):
            self.data += [node for node in q]
            len_q = len(q)
            for _ in range(len_q):
                node = q.pop(0)
                if node.left:
                    q.append(node.left)
                
                if node.right:
                    q.append(node.right)
        
    def insert(self, v):
        """
        :type v: int
        :rtype: int
        """
        parent = self.data[(len(self.data) - 1)//2]
        if parent.left:
            parent.right = TreeNode(v)
            self.data.append(parent.right)
        else:
            parent.left = TreeNode(v)
            self.data.append(parent.left)

        return parent.val
        
    def get_root(self):
        """
        :rtype: TreeNode
        """
        return self.data[0]
```

因为这个问题的原因，我们初始化操作有一种更简洁的写法

```python
class CBTInserter:
    def __init__(self, root):
        """
        :type root: TreeNode
        """
        self.data = list()
        self.data.append(root)
        for node in self.data:
            if node.left:
                self.data.append(node.left)
            if node.right:
                self.data.append(node.right)
```

考察的是很基础的概念。

**我将该问题的其他语言版本添加到了我的[GitHub Leetcode](https://github.com/luliyucoordinate/Leetcode)**

**如有问题，希望大家指出！！！**