---
layout: post
title: 三个点确定一个圆
category : 算法
tags : [cpp, 算法]
---

首先假设圆心为(x0, y0)，半径为r。则这个圆可以表示为：

- $(x - x0)^2+(y - y0)^2 = r^2​$

假设知道的三个点为(x1, y1)，(x2,y2)，(x3,y3)。那么：

- $(x1 - x0)^2+(y1 - y0)^2 = r^2$
- $(x2 - x0)^2+(y2 - y0)^2 = r^2$
- $(x3 - x0)^2+(y3 - y0)^2 = r^2$

消去$r^2$后变成

- $(x1 - x0)^2+(y1 - y0)^2 = (x2 - x0)^2+(y2 - y0)^2 $
- $(x1 - x0)^2+(y1 - y0)^2 = (x3 - x0)^2+(y3 - y0)^2 $

将未知量x0,y0移到左边就变为

- $(x1 - x2)x0 + (y1 - y2)y0 = \frac{(x1^2 - x2^2) + (y1^2 - y2^2)}{2}$
- $(x1 - x3)x0 + (y1 - y3)y0 = \frac{(x1^2 - x3^2) + (y1^2 - y3^2)}{2}$

首先我们要确定这个方程是不是有解，很简单，即判断行列式

- $ \left| \begin{array} ((x1 - x2) & (y1 - y2) \\(x1 - x3) & (y1 - y3) \end{array} \right | \neq 0$ 

设两个常量a1,a2

- $a1 = \frac{(x1^2 - x2^2) + (y1^2 - y2^2)}{2}$
- $a2 = \frac{(x1^2 - x3^2) + (y1^2 - y3^2)}{2}$

那么

- $x0 = \frac{(y1 - y2)a2 - (y1 - y3)a1}{(y1 - y2)(x1 - x3)-(x1 - x2)(y1-y3)}$
- $y0 = \frac{(x1 - x3)a1 - (x1 - x2)a2}{(y1 - y2)(x1 - x3)-(x1 - x2)(y1-y3)}$

最后代码如下

```python
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import Circle

def circle(x1, y1, x2, y2, x3, y3):
	a = x1 - x2
	b = y1 - y2
	c = x1 - x3
	d = y1 - y3
	a1 = ((x1 * x1 - x2 * x2) + (y1 * y1 - y2 * y2)) / 2.0
	a2 = ((x1 * x1 - x3 * x3) + (y1 * y1 - y3 * y3)) / 2.0
	theta = b * c - a * d;
	if abs(theta) < 1e-7:
		return -1
	x0 = (b * a2 - d * a1) / theta;
	y0 = (c * a1 - a * a2) / theta;
	r = np.sqrt(pow((x1 - x0), 2)+pow((y1 - y0), 2))
	fig = plt.figure()
	ax = fig.add_subplot(111)
	cir = Circle(xy = (x0, y0), radius = r, alpha=0.4)
	ax.add_patch(cir)
	plt.axis('scaled')
	plt.axis('equal')
	plt.plot(x1,y1,'r*',x2,y2,'r*',x3,y3,'r*')
	plt.show()

circle(0, 0, 0, 1, 1, 0)
```

结果为


<a href="http://wx1.sinaimg.cn/mw690/af2d2659ly1fk0l2a5uynj20ma0iymy5.jpg" data-lightbox="roadtrip">
<img src="http://wx1.sinaimg.cn/mw690/af2d2659ly1fk0l2a5uynj20ma0iymy5.jpg" class="img-fluid">
</a>

