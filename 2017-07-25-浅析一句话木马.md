---
layout: post
title: 	浅析一句话木马
category : 信息安全
tags : [木马, php, 原理]
stickie: true
---

一开始对于一句话木马感觉很神奇，因为它特别的短，用过的人都知道。分析原理后，又非常想知道到底是什么人想出这么一个好的想法，真的非常的天才。

以php一句话为例子

```php
<?php eval($_POST[c]); ?>
```
我么将这句话保存为x.php文件上传到网站中，通过菜刀可以轻松连接。

<center class="half">
    <img src="https://raw.githubusercontent.com/wiki/luliyucoordinate/ImageBed/caidao/2019_6_25_1.jpg" width="600">
</center>

究其原理其实很简单，看下面这个做法，通过对x.php中的c进行post

<center class="half">
    <img src="https://raw.githubusercontent.com/wiki/luliyucoordinate/ImageBed/caidao/2019_6_25_2.jpg" width="300">
</center>

菜刀的功能无非是把我们要post的数据传给了c，而这个c在菜刀中就是“密码”。

**一句话木马能连接成功有两个前提条件：** 

1.  服务器端没有禁止Adodb.Stream组件，因为我们使用一句话木马写入WebShell代码的条件是服务器端创建Adodb.Stream组件，如果该组件被禁用的话无法写入。 
2.  权限问题，如果当前的虚拟目录禁止user组或者everyone写入，同样不会成功。