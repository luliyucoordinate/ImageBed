---
layout: post
title: linux Day4
category : linux
tags : [linux]
stickie: true
---


fstat
===

fstat获取文件信息

```c
fstat(int fd, struct stat *buf)
```
stat获取文件信息

```c
int stat(const char *path, struct stat *buf)
```
stat结构主要描述文件的信息 ls的信息  
stat.st_mode判断文件类型  
S_ISREG(stat.st_mode)      regular file  
S_ISDIR(stat.st_mode)       directory  
stat.st_size代表文件大小

getpass
===

```c
char *getpass(const char *prompt)
```
读写用户输入，不回显  
prompt提示符   函数返回密码

fopen fclose fread fwrite
===

```c
FILE *p fopen(const char* path, const char *mode);
int fclose(FILE *stream);
```
Mode:
r    open text file for reading  
r+   open for writing and reading  
w    truncate(缩短) file to zero length orcreate text file for writing binary system  
wb   in the windows  
w+   open for reading writing .the file is created if it does not exist  
a    open for appending . the file is created if it does not exist  
a+   open for writing and reading(writing at end of file )the file is created if it does not exist

```c
size_t fread(void *ptr,size_t size, size_t nmeb, FILE *stream)
size_t fwrite(void *ptr,size_t size, size_t nmeb, FILE *stream)
```
ptr 指向那个缓冲区  
size控制记录大小  
nmemb记录数  
函数返回记录或写的记录数

库函数fopen fclose fread fwrite 尽量使用库函数，不要使用系统函数，便于移植

fprintf fscanf fgets fputs
===

```c
int fprintf(FILE *stream, const char *format,...);
```
与printf区别只是一个输入到标准输出文件，一个输出到普通文件

```c
int fscanf(FILE *stream, const char *format,...);
```
 不会读取文件末尾的回车

```c
char fgets(char *s, int size, FILE *stream);
```
fgets从文件读取一行，返回EOF代表文件结尾（会读取回车）

```c
int fputs(const char *s,FILE *stream);
```
fputs从文件写入一行

remove
===

```c
int remove(const char *pathname)
int remove(const char *oldpath, const char *newpath);
```
remove函数删除pathname指向的文件  
rename修改文件名  
执行成功返回0，执行失败返回-1，错误码保存在变量errno中

divWritelog
===

```c
void writelog(const char *log){
       time_t tDate;
       struct tm *eventTime;
       time(&amp;tDate);                      //get the current system time
       eventTime = localtime(&amp;tDate);     //make the time_t to the struct tm
       int iYear = eventTime-&gt;tm_year + 1900;
       int iMon = eventTime-&gt;tm_mon + 1;
       int iDay = eventTime-&gt;tm_mday;
       int iHour = eventTime-&gt;tm_hour;
       int iMin = eventTime-&gt;tm_min;
       int iSec = eventTime-&gt;tm_sec;
       char sDate[16];
       sprintf(sDate, "%04d-%02d-%02d", iYear, iMon, iDay); //right alignment
       char sTime[16];
       sprintf(sTime, "%02d:%02d:%02d", iHour, iMin, iSec);
       char s[1024];
       sprintf(s, "%s %s %s\n", sDate, sTime, log);
       FILE *fd = fopen("my.log", "a+");
       if(fd == NULL){
              printf("write og my.log error:%s \n", strerror(errno));
       }else{
              fputs(s, fd);
       }
       fclose(fd);
}
```

getcwd
===

```c
char *getcwd(char *buf, size_t size);
```
getcwd函数把当前工作目录的绝对路径名复制到buf，size表示buf的大小，buf不够返回NULL  
执行程序时所在的目录，不一定是程序所在的目录  
如果在根目录，则可以通过/1/main执行main程序  
宿主目录：用户登录时的目录

opendir readdir closedir
===

opendir打开目录         DIR *opendir(const char *pathname)  
readdir读取目录内容     struct dirent *readdir(DIR *dir)  
closedir关闭目录        int close(DIR *dir)  
<dirent.h>中声明,出错返回NULL

eclipse注释
===

ctrl +/         注释文件与取消注释文件 //  
ctrl+shift+/    注释文件    /**/  
ctrl+shift+\    取消注释文件  
ctrl+d          删除
