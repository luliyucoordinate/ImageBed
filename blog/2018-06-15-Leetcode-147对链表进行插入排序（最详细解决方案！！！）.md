---
layout: post
title: Leetcode 147:对链表进行插入排序（最详细解决方案！！！）
category : 算法
tags : [python, c, c++]
stickie: true
date: 2018-06-15 00:00:00
---

对链表进行插入排序。

<center>
	<img src=https://upload.wikimedia.org/wikipedia/commons/0/0f/Insertion-sort-example-300px.gif width="300">
</center>
插入排序的动画演示如上。从第一个元素开始，该链表可以被认为已经部分排序（用黑色表示）。
每次迭代时，从输入数据中移除一个元素（用红色表示），并原地将其插入到已排好序的链表中。

**插入排序算法：**

1. 插入排序是迭代的，每次只移动一个元素，直到所有元素可以形成一个有序的输出列表。
2. 每次迭代中，插入排序只从输入数据中移除一个待排序的元素，找到它在序列中适当的位置，并将其插入。
3. 重复直到所有输入数据插入完为止。

**示例 1：**

```
输入: 4->2->1->3
输出: 1->2->3->4
```

**示例 2：**

```
输入: -1->5->3->4->0
输出: -1->0->3->4->5
```

**解题思路**

因为有`insert`操作，所有我们上来就定义三个指针`pre`、`cur`、`lat`。我们首先考虑`2`应该插在哪？

<center class="half">
    <img src="https://raw.githubusercontent.com/wiki/luliyucoordinate/ImageBed/147/2019_3_24_1.png" width="400">
</center>

我们发现`2`比`tmp`小，所以我们需要将`2`插入到`tmp`前。

<center class="half">
    <img src="https://raw.githubusercontent.com/wiki/luliyucoordinate/ImageBed/147/2019_3_24_2.png" width="400">
</center>

我们主要实现的操作就是

```python
cur.next = lat.next
lat.next = tmp
pre.next = lat
lat = cur.next
```

<center class="half">
    <img src="https://raw.githubusercontent.com/wiki/luliyucoordinate/ImageBed/147/2019_3_24_3.png" width="400">
</center>

接着我们需要将`pre`和`tmp`复位，同时我们需要移动`cur`和`lat`找到下一个需要**被插入元素**的位置。也就是

<center class="half">
    <img src="https://raw.githubusercontent.com/wiki/luliyucoordinate/ImageBed/147/2019_3_24_4.png" width="400">
</center>

```python
pre = head
tmp = head.next
```

总体的算法思路就是通过`pre`和`tmp`移动到需要插入的位置，通过`cur`和`lat`移动到需要被插入元素的位置。

以下是这个过程的完整代码

```python
class Solution:
    def insertionSortList(self, head):
        """
        :type head: ListNode
        :rtype: ListNode
        """
        if head == None or head.next == None:
            return head

        h = ListNode(-1)
        h.next = head
        cur = head
        lat = cur.next
        while lat != None: 
            tmp, pre = h.next, h
            while tmp != lat and tmp.val < lat.val:
                tmp = tmp.next
                pre = pre.next
            if tmp == lat:
                cur = lat
            else:
                cur.next = lat.next
                lat.next = tmp
                pre.next = lat

            lat = cur.next

        return h.next
```

这个问题其实不是很复杂，主要就是指针比较多，一定要理清楚每个指针的含义。我们还有一个更简洁的写法

```python
class Solution:
    def insertionSortList(self, head):
        """
        :type head: ListNode
        :rtype: ListNode
        """
        if head == None or head.next == None:
            return head

        h = ListNode(-1)
        h.next = head
        pre = h
        cur = head
        while cur != None: 
            lat = cur.next
            if lat != None and lat.val < cur.val:#只有cur.next比cur小的时候我们才寻找插入点
                while pre.next != None and pre.next.val < lat.val:
                    pre = pre.next
                tmp = pre.next
                pre.next = lat
                cur.next = lat.next
                lat.next = tmp
                pre = h
            else:
                cur = lat
           
        return h.next
```

这种写法的好处是避免了大量的重复比较操作。

**我将该问题的其他语言版本添加到了我的[GitHub Leetcode](https://github.com/luliyucoordinate/Leetcode)**

**如有问题，希望大家指出！！！**