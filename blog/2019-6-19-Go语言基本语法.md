---
layout: post
title: Go语言基本语法
category : go
tags : [go]
stickie: true
date: 2019-6-19 00:00:00
---

# 0x01 内建变量类型

- `bool`、`string`
- `(u)int`、`(u)int8`、`(u)int16`、`(u)int32`、`(u)int64`、`uintptr`

- `byte`、`rune`
- `float32`、`float64`、`complex64`、`complex128`

`uintptr`是指针类型，`rune`是字符类型（4字节，也就是解决了其他语言`char`的编码问题），`complex`复数类型（很神奇，其他语言没有）。

在`go`语言中，我们使用复数的话，可以和数学中一样

```go
a := 1 + 1i
```

这点和`python`有一点区别，`python`中使用`j`表示虚数。

`go`语言中的强制类型转换类似于`c`语言，使用`type()`即可。

# 0x02 变量的定义

通过`var`关键字声明变量

```go
var variable type
```

和其他语言不同的是，`go`语言的变量类型是放在变量名之后的（为什么这样设计呢？）。并且`go`语言声明一个变量后会自动赋初值（这是一个不错的性质）。我们也可以自己赋初值，如下

```go
var a int = 3
```

定义多个变量

```go
var a, b int = 3, 4
```

同样作为一个新语言，`go`支持类型推导（类似于`cpp`的`auto`）

```go
var a, b = 3, "hello"
```

也可以这样写

```go
var (
	a = 3
    b = "hello"
)
```

我们也可以将`var`省略，不过我们需要通过`:=`替代`=`（这种写法和`python`非常类似）

```go
a, b := 3, "hello"
```

上述写法有一个限制**必须在{}中使用**。也就是对于包内的全局变量我们必须使用`var`定义。

# 0x03 常量的定义

常量的定义和`cpp`类似，使用`const`

```go
const a = 3
```

`const`数值可作为各种类型使用，也就是对于一些操作我们不需要强转。例如

```go
var c int = int(math.sqrt(a * a))
```

而如果`a`不是`const`的话，我们就需要这样写

```go
var c int = int(math.sqrt(float64(a * a)))
```

我们可以使用`const`定义枚举类型

```go
const (
	cpp = 0
    java = 1
    python = 2
)
```

我们可以使用`iota`简化上面的操作，`iota`是`go`语言的常量计数器，会给被赋值给`iota`的变量赋初值`0`，后面的变量赋初值`+1`（类似于`cpp`中的`enum`）

```go
const (
	cpp = iota 	// 0
    java   		// 1
    python 		// 2
    _
)
```

其中`_`表示跳过，这点和`python`很像。

# 0x04 条件语句

`go`的条件语句和`python`类似，不用在`if`后添加括号

```go
if condition {
} else {
}
```

`go`语言中的`if`还支持其他语言中的`for`类似功能

```go
if a, b := 3, 3 ; a != b {
}
```

但是这里有一点要注意，我们不能像其他语言那样去声明一个变量（只能赋值）

```go
if var a, b = 3, 3 ; a != b { 	// 	syntax error: var declaration not 
    							//	allowed in if initializer
}
```

`go`语言中的`switch`语法和其他语言不同，我们不需要写`break`（会自动添加）

```go
switch var0 {
    case val1:
        ...
    case val2:
        ...
    default:
        ...
}
```

如果不想`break`的话，我们只需在`break`的位置添加`fallthrough`即可。

`switch`后面也可以不添加表达式

```go
switch {
    case val1 == var0:
        ...
    case val2 == var0:
        ...
    default:
        ...
}
```

# 0x05 循环语句

写法上和其他语言类似，唯一的区别是不用写`括号`

```go
for init; condition; post { }
```

`init`、`condition`、`post`都是可以省略的。

在`go`语言中没有`while`关键字，但是我们可以使用`for`实现类似功能

```go
for condition { }
```

也就是我们省略了`init`和`post`。

在`go`语言中我们也有`for range`的写法

```go
for key, value := range oldMap {
    newMap[key] = value
}
```

# 0x06 函数

定义函数需要使用`func`关键字和`python`中的`def`类似。函数的定义与变量的定义类似，我们都是和其他语言反过来。

```go
func function_name( [parameter list] ) [return_types] {

}
```

函数名在前面，返回类型在后面。

我们也可以返回多个值

```go
func swap(x, y string) (string, string) {
   return y, x
}
```

如果其中一个返回值我们不想要的话，可以使用`_`替代（和`python`类似）

```go
a, _ := swap(a, b)
```

复合函数的定义也非常简单

```go
func apply(op func(int, int) int, a, b int) int {
    return op(a, b)
}
```

我们在上面定义了一个函数类型参数`op`。上面这种东西和`python`里面的`装饰器`很类似。上面函数的传入操作，我们可以使用匿名函数（`go`语言中没有`lambda`表达式）

```go
func ( [parameter list] ) [return_types] {
}
```

也就是省略函数名。

`go`语言中支持可变参数列表

```go
func sum(numbers ...int) int {
	s := 0
	for _, val := range numbers {
		s += val
	}
	return s
}
```

# 0x07 指针

指针的定义

```go
var var_name *var-type
```

在`go`语言中指针不能做计算，也就是不能`++`、`--`，我们仅仅访问指针所指向的内容`*var_name`。

在`go`语言中空指针使用`nil`表示。

说道指针，那我们不得不谈引用，在`go`中参数通过值传递或者指针传递（没有引用，这是`c`语言的特性）。

