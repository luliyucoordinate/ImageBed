---
layout: post
title: Leetcode 982：按位与为零的三元组（超详细的解法！！！）
category : 算法
tags : [python, c, c++]
stickie: true
date: 2019-1-31 00:00:00
---

给定一个整数数组 `A`，找出索引为 (i, j, k) 的三元组，使得：

- `0 <= i < A.length`
- `0 <= j < A.length`
- `0 <= k < A.length`
- `A[i] & A[j] & A[k] == 0`，其中 `&` 表示按位与（AND）操作符。

**示例：**

```
输入：[2,1,3]
输出：12
解释：我们可以选出如下 i, j, k 三元组：
(i=0, j=0, k=1) : 2 & 2 & 1
(i=0, j=1, k=0) : 2 & 1 & 2
(i=0, j=1, k=1) : 2 & 1 & 1
(i=0, j=1, k=2) : 2 & 1 & 3
(i=0, j=2, k=1) : 2 & 3 & 1
(i=1, j=0, k=0) : 1 & 2 & 2
(i=1, j=0, k=1) : 1 & 2 & 1
(i=1, j=0, k=2) : 1 & 2 & 3
(i=1, j=1, k=0) : 1 & 1 & 2
(i=1, j=2, k=0) : 1 & 3 & 2
(i=2, j=0, k=1) : 3 & 2 & 1
(i=2, j=1, k=0) : 3 & 1 & 2
```

**提示：**

1. `1 <= A.length <= 1000`
2. `0 <= A[i] < 2048`

**解题思路**

首先我们可以很明确一点就是不断`&`的过程中， 数一定是不断在变小的，那么我们完全可以建立一个字典存放所有数的`$`结果的**数量**（因为我们在计算的过程会出现重复）。我们再次遍历`A`中的元素`a`，然后判断`a`与我们存放在字典中的元素是否`&`结果为`0`，如果是的话，我们就需要将字典中的对应值添加到结果中去即可。

```python
class Solution:
    def countTriplets(self, A: 'List[int]') -> 'int':
        dic = dict()
        for a in A:
            for b in A:
                tmp = a&b
                dic[tmp] = dic.get(tmp, 0) + 1
        res = 0
        for a in A:
            for k, v in dic.items():
                if k & a == 0:
                    res += v
        return res
```

是不是很简单，感觉这个题目没有`hard`难度。其实这就变成了一个考察高效编码的问题，我们还有一个更快的解法。

```python
class Solution:
    def countTriplets(self, A: 'List[int]') -> 'int':
        arr = [0]*(1 << 16)
        mask = (1 << 16) - 1
        for a in A:
            k = mask ^ a
            i = k
            while i:
                arr[i ^ a] += 1
                i = (i - 1) & k
            else:
                arr[i ^ a] += 1
                
        res = 0
        for a in A:
            for b in A:
                res += arr[mask ^ (a & b)]
        
        return res
```

**我将该问题的其他语言版本添加到了我的[GitHub Leetcode](https://github.com/luliyucoordinate/Leetcode)**

**如有问题，希望大家指出！！！**