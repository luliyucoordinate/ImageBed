---
layout: post
title: Leetcode 174:地下城游戏（超详细解决方案！！！）
category : 算法
tags : [python, c, c++]
stickie: true
date: 2019-1-10 00:00:00
---

一些恶魔抓住了公主（**P**）并将她关在了地下城的右下角。地下城是由 M x N 个房间组成的二维网格。我们英勇的骑士（**K**）最初被安置在左上角的房间里，他必须穿过地下城并通过对抗恶魔来拯救公主。

骑士的初始健康点数为一个正整数。如果他的健康点数在某一时刻降至 0 或以下，他会立即死亡。

有些房间由恶魔守卫，因此骑士在进入这些房间时会失去健康点数（若房间里的值为*负整数*，则表示骑士将损失健康点数）；其他房间要么是空的（房间里的值为 *0*），要么包含增加骑士健康点数的魔法球（若房间里的值为*正整数*，则表示骑士将增加健康点数）。

为了尽快到达公主，骑士决定每次只向右或向下移动一步。 

**编写一个函数来计算确保骑士能够拯救到公主所需的最低初始健康点数。**

例如，考虑到如下布局的地下城，如果骑士遵循最佳路径 `右 -> 右 -> 下 -> 下`，则骑士的初始健康点数至少为 **7**。

| -2 (K) |  -3  |   3    |
| :----: | :--: | :----: |
|   -5   | -10  |   1    |
|   10   |  30  | -5 (P) |

**说明:**

- 骑士的健康点数没有上限。
- 任何房间都可能对骑士的健康点数造成威胁，也可能增加骑士的健康点数，包括骑士进入的左上角房间以及公主被监禁的右下角房间。

**解题思路**

一看到这个问题首先想到的就是动态规划，其次想的就是自顶向下，但是这样想的话就会有一个问题，就是我们需要判断每次到达一个房间后，我们的血量不能是负数，这给我们编写代码造成了很大的困难。如果采用自底向上的思路去做的话，那么问题就会变得简单很多（而且我觉得你应该做到，拿到这个问题首先想到的就是自底向上，这是一种直觉）。后续问题就是之前的问题[Leetcode 62：不同路径（最详细的解法！！！）](https://blog.csdn.net/qq_17550379/article/details/82815121)非常类似啦。我们只需要取右和下的最小值（我们需要计算最少的能量），然后减去`dungoen[i][j]`，并且保证到达当前房间后的血量大于等于`0`就行了

- $f(i,j)=max(0,min(f(i+1,j),f(i,j+1))-dungeon[i][j])$

对于边界问题我们单独处理。最后我们只需要取结果`f(0,0)+1`即可（根据题目中的例子）。

```python
class Solution:
    def calculateMinimumHP(self, dungeon):
        """
        :type dungeon: List[List[int]]
        :rtype: int
        """
        row, col = len(dungeon), len(dungeon[0])
        mem = [[0]*col for _ in range(row)]

        for i in range(row-1,-1,-1):
            for j in range(col-1,-1,-1):
                if i == row-1 and j == col-1:
                    mem[i][j] = max(0, -dungeon[i][j])
                elif i == row-1:
                    mem[i][j] = max(0, mem[i][j+1] - dungeon[i][j])
                elif j == col-1:
                    mem[i][j] = max(0, mem[i+1][j] - dungeon[i][j])
                else:
                    mem[i][j] = max(0, min(mem[i+1][j], mem[i][j+1]) - dungeon[i][j])
                
        return mem[0][0] + 1
```

对于这种问题直觉很重要，没有那种感觉的话，说明你的思考不够多。

**我将该问题的其他语言版本添加到了我的[GitHub Leetcode](https://github.com/luliyucoordinate/Leetcode)**

**如有问题，希望大家指出！！！**