---
layout: post
title: Leetcode 34：在排序数组中查找元素的第一个位置和最后一个位置（最详细的解法！！！）
category : 算法
tags : [python, c, c++]
stickie: true
date: 2018-10-20 00:00:00
---

给定一个按照升序排列的整数数组 `nums`，和一个目标值 `target`。找出给定目标值在数组中的开始位置和结束位置。

你的算法时间复杂度必须是 *O*(log *n*) 级别。

如果数组中不存在目标值，返回 `[-1, -1]`。

**示例 1:**

```
输入: nums = [5,7,7,8,8,10], target = 8
输出: [3,4]
```

**示例 2:**

```
输入: nums = [5,7,7,8,8,10], target = 6
输出: [-1,-1]
```

**解题思路**

这个问题十分简单，实际上就是`floor`和`ceil`问题，参考[Leetcode 二分法问题总结（超详细！！！）](https://blog.csdn.net/qq_17550379/article/details/86559449)中的写法。

```python
class Solution:
    def searchRange(self, nums, target):
        """
        :type nums: List[int]
        :type target: int
        :rtype: List[int]
        """
        res = [-1, -1]
        if not nums or target == None:
            return res
        
        l, r = 0, len(nums) - 1
        while l <= r:
            mid = (l + r) //2 
            if target == nums[mid]:
                res[0] = mid
                r = mid - 1
            elif target > nums[mid]:
                l = mid + 1
            else:
                r = mid - 1 
                
        l, r = 0, len(nums) - 1
        while l <= r:
            mid = (l + r)//2
            if target == nums[mid]:
                res[1] = mid
                l = mid + 1
            elif target > nums[mid]:
                l = mid + 1
            else:
                r = mid - 1
                
        return res
```

前一个循环中的算法正确性证明：

初始化：我们假设都给定了正确类型的`nums`和`target`。

保持：当`nums[mid] == target`的时候，显然我们找到了`target`，但是我们需要找的是**第一个**等于`target`的元素，所以我们需要在`[l, mid-1]`中继续寻找。当`target > nums[mid]`的时候，此时`[l, mid]`中的元素全部小于`target`，此时等于`target`的元素只会存在于`[mid+1, r]`这个区间中。当`target < nums[mid]`的时候，此时`[mid, r]`这个区间内的元素一定大于`target`，此时`target`只会存在于`[l, mid-1]`这个区间内。

终止：当`l>r`，此时区间`[l, r]`中没有元素了，如果`nums`中存在`target`，则`l`是等于`target`的第一个位置（很容易分析，假设`l==r`的时候`target == nums[mid]`，此时`r=mid-1`而`l=mid`）。

在上述的写法中我们使用了一个`trick`，我们在`==`的时候就记录结果，如果没有`==`的话，那么结果自然就是`-1`（初始化的值）。

**我将该问题的其他语言版本添加到了我的[GitHub Leetcode](https://github.com/luliyucoordinate/Leetcode)**

**如有问题，希望大家指出！！！**

