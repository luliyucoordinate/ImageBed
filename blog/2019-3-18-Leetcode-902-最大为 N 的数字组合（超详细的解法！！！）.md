---
layout: post
title: Leetcode 902：最大为 N 的数字组合（超详细的解法！！！）
category : 算法
tags : [python, c, c++]
stickie: true
date: 2019-3-18 00:00:00
---

我们有一组**排序的**数字 `D`，它是  `{'1','2','3','4','5','6','7','8','9'}` 的非空子集。（请注意，`'0'` 不包括在内。）

现在，我们用这些数字进行组合写数字，想用多少次就用多少次。例如 `D = {'1','3','5'}`，我们可以写出像 `'13', '551', '1351315'` 这样的数字。

返回可以用 `D` 中的数字写出的小于或等于 `N` 的正整数的数目。 

**示例 1：**

```
输入：D = ["1","3","5","7"], N = 100
输出：20
解释：
可写出的 20 个数字是：
1, 3, 5, 7, 11, 13, 15, 17, 31, 33, 35, 37, 51, 53, 55, 57, 71, 73, 75, 77.
```

**示例 2：**

```
输入：D = ["1","4","9"], N = 1000000000
输出：29523
解释：
我们可以写 3 个一位数字，9 个两位数字，27 个三位数字，
81 个四位数字，243 个五位数字，729 个六位数字，
2187 个七位数字，6561 个八位数字和 19683 个九位数字。
总共，可以使用D中的数字写出 29523 个整数。
```

**提示：**

1. `D` 是按排序顺序的数字 `'1'-'9'` 的子集。
2. `1 <= N <= 10^9`

**解题思路**

这个问题和之前的问题[Leetcode 788：旋转数字（超详细的解法！！！）](https://blog.csdn.net/qq_17550379/article/details/88647103)非常类似。我们采用同样的方式思考，例如`1234`，我们可以先计算`[1,999]`内有多少个数，怎么算？很简单，对于`[1,9]`总共有`len(D)`个数，对于`[10,99]`，总共有`len(D)**2`个数，通过对于`[100,999]`总共有`len(D)**3`个数，最后将所有的数加起来就行了。

接着思考`[1000,1199]`内有多少个数，怎么算？首先计算出`[0,1]`这个区间内只有一个数满足，而后面总共有两种选择，也就是`len(D)**2`，所以结果就是`1*len(D)**2`。接着思考`[1200,1229]`，此时我们发现`2`不在`D`中，所以我们直接返回最后的结果就好啦！最后的结果就是`100`。

由于上面的例子提前结束了，所以我们还有最后的`[1234, 1234]`没有去考虑。如果此时的例子是`1357`，我们最后就要思考`1357`是不是满足条件，怎么做？一种做法就是和之前问题的处理手法类似，也就是`set(N).issubset(set(D))`。或者我们只需要判断我们是不是遍历到最后一个元素就行了，因为只要前面的元素都满足条件，那么`D`一定满足条件。

将上述过程整理成代码

```python
class Solution:
    def atMostNGivenDigitSet(self, D: List[str], N: int) -> int:
        N = str(N)
        n = len(N)
        res = sum(len(D) ** i for i in range(1, n))
        i = 0
        while i < n:
            res += sum(c < N[i] for c in D) * (len(D) ** (n - i - 1))
            if N[i] not in D: 
                break
            i += 1
        return res + (i == n)
```

在这种写法中我们使用之前描述的方法，就是将**整个数**放到最后去考虑。这里有一个`trick`，就是我们可以

```python
N = str(N+1)
```

这样就不用最后将整个数单独考虑。

reference:

https://leetcode.com/problems/numbers-at-most-n-given-digit-set/submissions/

**我将该问题的其他语言版本添加到了我的[GitHub Leetcode](https://github.com/luliyucoordinate/Leetcode)**

**如有问题，希望大家指出！！！**