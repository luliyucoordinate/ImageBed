---
layout: post
title: oracle配置
category : 数据库
tags : [oracle]
stickie: true
---


Redhat enterprise 7安装oracle12
===


安装必须的包
---

根据oracle官网上提供的文档，得到如下信息

```sql
binutils-2.23.52.0.1-12.el7.x86_64 
compat-libcap1-1.10-3.el7.x86_64 
gcc-4.8.2-3.el7.x86_64 
gcc-c++-4.8.2-3.el7.x86_64 
glibc-2.17-36.el7.i686
glibc-2.17-36.el7.x86_64 
glibc-devel-2.17-36.el7.i686 
glibc-devel-2.17-36.el7.x86_64 
ksh
libaio-0.3.109-9.el7.i686 
libaio-0.3.109-9.el7.x86_64 
libaio-devel-0.3.109-9.el7.i686 
libaio-devel-0.3.109-9.el7.x86_64 
libgcc-4.8.2-3.el7.i686 
libgcc-4.8.2-3.el7.x86_64 
libstdc++-4.8.2-3.el7.i686 
libstdc++-4.8.2-3.el7.x86_64 
libstdc++-devel-4.8.2-3.el7.i686 
libstdc++-devel-4.8.2-3.el7.x86_64 
libXi-1.7.2-1.el7.i686 
libXi-1.7.2-1.el7.x86_64 
libXtst-1.2.2-1.el7.i686 
libXtst-1.2.2-1.el7.x86_64 
unixODBC-2.3.1-10.el7.i686.rpm
unixODBC-2.3.1-10.el7.x86_64.rpm
unixODBC-devel-2.3.1-10.el7.i686.rpm
unixODBC-devel-2.3.1-10.el7.x86_64.rpm
make-3.82-19.el7.x86_64 
sysstat-10.1.5-1.el7.x86_64
```
无论你是选择rpm还是选择yum，这些包必须安装好，在Red Hat Enterprise Linux 7.0 的光盘中，
这些包都存在，这里说一下Red Hat Enterprise Linux配置本地源的事情



配置本地源
---

我从来都是将Red Hat Enterprise Linux 7.0的光盘.iso文件上传到系统里，在这里，我将光盘传到/home/yunchu/Desktop里，yunchu是我个人用户名。  
获得超级权限后在/media下，新建一个文件夹cdrom。具体将光盘挂载到什么地方，自己选择。我选择挂载到/media/cdrom下  

```sql
[root@localhost Desktop]#mount rhel-server-7.0-x86_64-dvd.iso /media/cdrom
```
在/etc/yum.repos.d/ 下面

```sql
[root@localhost yum.repos.d]# touch rhel-media.repo //新建一个rhel-media.repo文件
[root@localhost yum.repos.d]# vi rhel-media.repo //编辑文件

[rhel-media]  #1行
name=Red Hat Enterprise Linux 7.0
baseurl=file:///media/cdrom
enabled=1
gpgcheck=1
gpgkey=file:///media/cdrom/RPM-GPG-KEY-redhat-release  #6行
//#1行到#6行以直接复制到rhel-media.repo中，汉字不需要复制，这段说明不需要复制
[root@localhost yum.repos.d]# yum clean all
[root@localhost yum.repos.d]# yum makecache
```
搞定  
用yum安装很快的



添加组和用户
---
```shell
groupadd dba
groupadd oinstall
useradd oracle –d /home/oracle –g oinstall –G dba –m 
passwd oracle
```
不能设123 QAQ 



预先创建安装目录
---
```shell
mkdir –p /opt/oracle/product
mkdir –p /opt/oracle/product/12.2.1
mkdir –p /opt/oraInventory
mkdir –p /opt/oracle/oradata
```
设置目录的所有者所属组和权限

```shell
chown –R oracle.oinstall /opt/oracle
chown –R oracle.oinstall /opt/oracle/oradata
chown –R oracle.oinstall /opt/oracle/product/12.2.1
chown –R oracle.oinstall /opt/oraInventory
chown oracle.dba /opt/oracle
```


设置环境变量
---
```shell
su – oracle
cd
vi .bash_profile

export ORACLE_BASE=/opt/oracle
export ORACLE_HOME=$ORACLE_BASE/product/12.2.1
export ORACLE_OWNER=oracle
export ORACLE_SID=orcl
export PATH=$PATH:$HOME/bin:.:$ORACLE_HOME/bin
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ORACLE_HOME/lib
export NLS_LANG="SIMPLIFIED CHINESE_CHINA.AL32UTF8"
```
后退出  
. .bash_profile让文件生效

在oracle用户下解压oracle安装包

```
mv linuxx64_12201_database.zip /home/oracle
```


安装oracle database
---

用户oracle登陆  
进入database目录  
执行

```shell
chmod +x install/.oui
chomd +x install/unzip
chmod +x runInstaller
./runInstaller
```


配置监听程序
---

打开一个新的终端，执行netca  
设置

<a href="http://wx2.sinaimg.cn/mw690/af2d2659gy1fe14zsdobfj20gh0awaej.jpg" data-lightbox="roadtrip">
<img src="http://wx2.sinaimg.cn/mw690/af2d2659gy1fe14zsdobfj20gh0awaej.jpg" class="img-fluid">
</a>
<a href="http://wx4.sinaimg.cn/mw690/af2d2659gy1fe14zstl29j20gl0azaec.jpg" data-lightbox="roadtrip">
<img src="http://wx4.sinaimg.cn/mw690/af2d2659gy1fe14zstl29j20gl0azaec.jpg" class="img-fluid">
</a>
<a href="http://wx3.sinaimg.cn/mw690/af2d2659gy1fe14zta6hdj20gm0b7gp5.jpg" data-lightbox="roadtrip">
<img src="http://wx3.sinaimg.cn/mw690/af2d2659gy1fe14zta6hdj20gm0b7gp5.jpg" class="img-fluid">
</a>
<a href="http://wx4.sinaimg.cn/mw690/af2d2659gy1fe14ztplgpj20gl0b5gpq.jpg" data-lightbox="roadtrip">
<img src="http://wx4.sinaimg.cn/mw690/af2d2659gy1fe14ztplgpj20gl0b5gpq.jpg" class="img-fluid">
</a>
<a href="http://wx2.sinaimg.cn/mw690/af2d2659gy1fe14zukm5aj20gl0b7q66.jpg" data-lightbox="roadtrip">
<img src="http://wx2.sinaimg.cn/mw690/af2d2659gy1fe14zukm5aj20gl0b7q66.jpg" class="img-fluid">
</a>
<a href="http://wx4.sinaimg.cn/mw690/af2d2659gy1fe14zu5pnyj20gh0b177e.jpg" data-lightbox="roadtrip">
<img src="http://wx4.sinaimg.cn/mw690/af2d2659gy1fe14zu5pnyj20gh0b177e.jpg" class="img-fluid">
</a>
<a href="http://wx4.sinaimg.cn/mw690/af2d2659gy1fe14zuxpbgj20gj0b3n1p.jpg" data-lightbox="roadtrip">
<img src="http://wx4.sinaimg.cn/mw690/af2d2659gy1fe14zuxpbgj20gj0b3n1p.jpg" class="img-fluid">
</a>

再次打开netca设置  

<a href="http://wx3.sinaimg.cn/mw690/af2d2659gy1fe14zvl330j20gl0awn1c.jpg" data-lightbox="roadtrip">
<img src="http://wx3.sinaimg.cn/mw690/af2d2659gy1fe14zvl330j20gl0awn1c.jpg" class="img-fluid">
</a>
<a href="http://wx1.sinaimg.cn/mw690/af2d2659gy1fe14zvxdrqj20gk0azn1l.jpg" data-lightbox="roadtrip">
<img src="http://wx1.sinaimg.cn/mw690/af2d2659gy1fe14zvxdrqj20gk0azn1l.jpg" class="img-fluid">
</a>
<a href="http://wx2.sinaimg.cn/mw690/af2d2659gy1fe14zwd6uaj20gk0b0ae0.jpg" data-lightbox="roadtrip">
<img src="http://wx2.sinaimg.cn/mw690/af2d2659gy1fe14zwd6uaj20gk0b0ae0.jpg" class="img-fluid">
</a>
<a href="http://wx1.sinaimg.cn/mw690/af2d2659gy1fe14zwrhj6j20gh0b141x.jpg" data-lightbox="roadtrip">
<img src="http://wx1.sinaimg.cn/mw690/af2d2659gy1fe14zwrhj6j20gh0b141x.jpg" class="img-fluid">
</a>
<a href="http://wx2.sinaimg.cn/mw690/af2d2659gy1fe14zx2ozaj20gh0b10w8.jpg" data-lightbox="roadtrip">
<img src="http://wx2.sinaimg.cn/mw690/af2d2659gy1fe14zx2ozaj20gh0b10w8.jpg" class="img-fluid">
</a>
<a href="http://wx4.sinaimg.cn/mw690/af2d2659gy1fe14zxhkxwj20gk0azgpn.jpg" data-lightbox="roadtrip">
<img src="http://wx4.sinaimg.cn/mw690/af2d2659gy1fe14zxhkxwj20gk0azgpn.jpg" class="img-fluid">
</a>

这里填写的是自己的IP  

<a href="http://wx1.sinaimg.cn/mw690/af2d2659gy1fe14zyb3kpj20gj0az77t.jpg" data-lightbox="roadtrip">
<img src="http://wx1.sinaimg.cn/mw690/af2d2659gy1fe14zyb3kpj20gj0az77t.jpg" class="img-fluid">
</a>
<a href="http://wx3.sinaimg.cn/mw690/af2d2659gy1fe14zxvbwrj20gg0azq6i.jpg" data-lightbox="roadtrip">
<img src="http://wx3.sinaimg.cn/mw690/af2d2659gy1fe14zxvbwrj20gg0azq6i.jpg" class="img-fluid">
</a>
<a href="http://wx3.sinaimg.cn/mw690/af2d2659gy1fe14zynpmsj20gi0axtbs.jpg" data-lightbox="roadtrip">
<img src="http://wx3.sinaimg.cn/mw690/af2d2659gy1fe14zynpmsj20gi0axtbs.jpg" class="img-fluid">
</a>
<a href="http://wx2.sinaimg.cn/mw690/af2d2659gy1fe14zyzpcoj20gh0b2diz.jpg" data-lightbox="roadtrip">
<img src="http://wx2.sinaimg.cn/mw690/af2d2659gy1fe14zyzpcoj20gh0b2diz.jpg" class="img-fluid">
</a>
<a href="http://wx1.sinaimg.cn/mw690/af2d2659gy1fe14zzhjfpj20gl0b4q7k.jpg" data-lightbox="roadtrip">
<img src="http://wx1.sinaimg.cn/mw690/af2d2659gy1fe14zzhjfpj20gl0b4q7k.jpg" class="img-fluid">
</a>


添加数据库用户
---

用oracle登陆linux，在命令行输入

```shell
sqlplus /nolog
```
进入sqlplus命令提示符，输入

```shell
conn /as sysdba
```
在sqlplus 命令提示符输入  
create user dbuser1 identified by dbuser1; 一定要以;结尾

在这里我们碰到这个问题  
oracle报ORA-01034错误  
解决办法是  
1. connect  /as  sysdba;   
2. startup  
3. exit  
QAQ不幸的是又再次报错了  
oracle12创建用户错误ORA-65096: 公用用户名或角色名无效 invalid common user or role name  
解决办法  

```sql
SQL> create user C##fdf01 IDENTIFIED BY  fdf01;
User created.
```
根据错误提示了解，在CDB中用户得以C##开头;  
做完这些后，给用户添加权限  

```sql
grant connect,resource to dbuser1;
```
退出现在的用户，我们登陆到这个用户  
使用这个指令  
sqlplus 账户名/密码@orcl   注意这里的orcl是前面设置的



linux下停止oracle的方法
---

在oracle用户下

```sql
sqlplus /nolog
connect /as sysdba;
shutdown;
```
使用quit命令退出sqlplus
在命令提示符下执行

```shell
lsnrctl
```
在命令提示符下执行

```shell
stop
```


启动oracle的方法
---

在oracle用户下

```sql
sqlplus /nolog
connect /as sysdba;
startup
```
quit命令退出sqlplus  
在命令行执行  

```shell
lsnrctl
```
在lsnrctl提示符执行

```sql
start
```
如果想修改用户密码

```sql
alter user dbuser1 identified by newpasswd
```
如果想删除该用户

```sql
drop user dbuser1
```


积累
===

设置字符启动界面

```shell
systemctl set-default multi-user.target
```
图形界面  
graphical.target  
查看剩余空间  
df /opt  
mysql端口是3306  
oracle端口是1521  

解决退格键回显的问题  
1.  要使用回删键（backspace）时，同时按住ctrl键  
2.  设定环境变量  
在bash下：$ stty erase ^?  
或者把 stty erase ^? 添加到.bash_profile中。  
在csh下：$ stty erase ^H  
或者把 stty erase ^H 添加到.cshrc中  
3.  在脚本的开头可结尾 参数 stty erase ^H stty erase ^?  


