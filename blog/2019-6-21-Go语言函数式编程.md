---
layout: post
title: Go语言函数式编程
category : go
tags : [go]
stickie: true
date: 2019-6-21 00:00:00
---

# 0x01 函数式编程

- 函数是一等公民：参数，变量，返回值都是函数
- 高级函数
- 函数（闭包）

更加严格的定义

- 不可变性：不能有状态，只有常量和函数
- 函数只能有一个参数

# 0x02 闭包

函数体中包含`自有变量`和`局部变量`

```go
func adder() func(int) int {
	sum := 0
	return func(v int) int {
		sum += v
		return sum
	}
}
```

这里的`sum`就是自由变量，`v`是局部变量。

在`cpp`中同样支持闭包

```cpp
auto adder() {
    auto sum = 0;
    return [=] (int value) mutable {
        sum += value;
        return sum;
    };
}
```

在`python`中也是支持的

```python
def adder():
    sum = 0
    def f(value):
        nonlocal sum
        sum += value
        return sum
    return f
```

我们可以通过闭包实现斐波那契数列

```go
func fibonacci() func() int {
    a, b := 0, 1
    return func() int {
        a, b = b, a + b
        return a
    }
}
```

# 0x03 函数实现接口

```go
type intGen func() int
func (g intGen) Read(p []byte) (n int, err error) {
    next := g()
    s := fmt.Sprintf("%d\n", next)
    return  strings.NewReader(s).Read(p)
}
```